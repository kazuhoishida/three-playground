var it=Object.defineProperty,st=Object.defineProperties;var rt=Object.getOwnPropertyDescriptors;var ge=Object.getOwnPropertySymbols;var Oe=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable;var Ue=(e,t,n)=>t in e?it(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,q=(e,t)=>{for(var n in t||(t={}))Oe.call(t,n)&&Ue(e,n,t[n]);if(ge)for(var n of ge(t))ke.call(t,n)&&Ue(e,n,t[n]);return e},Q=(e,t)=>st(e,rt(t));var V=(e,t)=>{var n={};for(var i in e)Oe.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&ge)for(var i of ge(e))t.indexOf(i)<0&&ke.call(e,i)&&(n[i]=e[i]);return n};import{D as at,H as te,F as Te,a as ve,L as ze,b as N,r as l,_ as je,u as ne,S as me,W as ot,c as Me,d as ut,B as pe,C as lt,e as ct,f as ht,E as dt,g as Se,V as re,h as ft,A as pt,i as ee,j as O,k as ye,l as a,m as D,n as ae,P as oe,O as ue,o as we,p as mt,q as W,N as ie,s as le,U as se,M as gt,t as I,v as U,w as vt,x as Et,y as xt,z as bt,R as Xe,G as Tt,I as f,J as yt,K as Mt,Q as ce,T as St,X as wt,Y as De,Z as _t,$ as Ee,a0 as Rt,a1 as xe,a2 as Ye,a3 as At,a4 as Bt,a5 as Ct}from"./index.64bc5e5f.js";class Dt extends at{constructor(t){super(t),this.type=te}parse(t){const u=function(c,v){switch(c){case 1:console.error("THREE.RGBELoader Read Error: "+(v||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(v||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(v||""));break;default:case 4:console.error("THREE.RGBELoader: Error: "+(v||""))}return-1},E=`
`,g=function(c,v,_){v=v||1024;let T=c.pos,y=-1,m=0,B="",R=String.fromCharCode.apply(null,new Uint16Array(c.subarray(T,T+128)));for(;0>(y=R.indexOf(E))&&m<v&&T<c.byteLength;)B+=R,m+=R.length,T+=128,R+=String.fromCharCode.apply(null,new Uint16Array(c.subarray(T,T+128)));return-1<y?(_!==!1&&(c.pos+=m+y+1),B+R.slice(0,y)):!1},A=function(c){const v=/^#\?(\S+)/,_=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,S=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,T=/^\s*FORMAT=(\S+)\s*$/,y=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,m={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let B,R;if(c.pos>=c.byteLength||!(B=g(c)))return u(1,"no header found");if(!(R=B.match(v)))return u(3,"bad initial token");for(m.valid|=1,m.programtype=R[1],m.string+=B+`
`;B=g(c),B!==!1;){if(m.string+=B+`
`,B.charAt(0)==="#"){m.comments+=B+`
`;continue}if((R=B.match(_))&&(m.gamma=parseFloat(R[1])),(R=B.match(S))&&(m.exposure=parseFloat(R[1])),(R=B.match(T))&&(m.valid|=2,m.format=R[1]),(R=B.match(y))&&(m.valid|=4,m.height=parseInt(R[1],10),m.width=parseInt(R[2],10)),m.valid&2&&m.valid&4)break}return m.valid&2?m.valid&4?m:u(3,"missing image size specifier"):u(3,"missing format specifier")},C=function(c,v,_){const S=v;if(S<8||S>32767||c[0]!==2||c[1]!==2||c[2]&128)return new Uint8Array(c);if(S!==(c[2]<<8|c[3]))return u(3,"wrong scanline width");const T=new Uint8Array(4*v*_);if(!T.length)return u(4,"unable to allocate buffer space");let y=0,m=0;const B=4*S,R=new Uint8Array(4),F=new Uint8Array(B);let Ne=_;for(;Ne>0&&m<c.byteLength;){if(m+4>c.byteLength)return u(1);if(R[0]=c[m++],R[1]=c[m++],R[2]=c[m++],R[3]=c[m++],R[0]!=2||R[1]!=2||(R[2]<<8|R[3])!=S)return u(3,"bad rgbe scanline format");let he=0,j;for(;he<B&&m<c.byteLength;){j=c[m++];const X=j>128;if(X&&(j-=128),j===0||he+j>B)return u(3,"bad scanline data");if(X){const Y=c[m++];for(let Le=0;Le<j;Le++)F[he++]=Y}else F.set(c.subarray(m,m+j),he),he+=j,m+=j}const nt=S;for(let X=0;X<nt;X++){let Y=0;T[y]=F[X+Y],Y+=S,T[y+1]=F[X+Y],Y+=S,T[y+2]=F[X+Y],Y+=S,T[y+3]=F[X+Y],y+=4}Ne--}return T},w=function(c,v,_,S){const T=c[v+3],y=Math.pow(2,T-128)/255;_[S+0]=c[v+0]*y,_[S+1]=c[v+1]*y,_[S+2]=c[v+2]*y,_[S+3]=1},P=function(c,v,_,S){const T=c[v+3],y=Math.pow(2,T-128)/255;_[S+0]=ve.toHalfFloat(Math.min(c[v+0]*y,65504)),_[S+1]=ve.toHalfFloat(Math.min(c[v+1]*y,65504)),_[S+2]=ve.toHalfFloat(Math.min(c[v+2]*y,65504)),_[S+3]=ve.toHalfFloat(1)},M=new Uint8Array(t);M.pos=0;const d=A(M);if(d!==-1){const c=d.width,v=d.height,_=C(M.subarray(M.pos),c,v);if(_!==-1){let S,T,y,m;switch(this.type){case Te:m=_.length/4;const B=new Float32Array(m*4);for(let F=0;F<m;F++)w(_,F*4,B,F*4);S=B,y=Te;break;case te:m=_.length/4;const R=new Uint16Array(m*4);for(let F=0;F<m;F++)P(_,F*4,R,F*4);S=R,y=te;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type);break}return{width:c,height:v,data:S,header:d.string,gamma:d.gamma,exposure:d.exposure,format:T,type:y}}}return null}setDataType(t){return this.type=t,this}load(t,n,i,s){function r(o,u){switch(o.type){case Te:o.encoding=ze,o.minFilter=N,o.magFilter=N,o.generateMipmaps=!1,o.flipY=!0;break;case te:o.encoding=ze,o.minFilter=N,o.magFilter=N,o.generateMipmaps=!1,o.flipY=!0;break}n&&n(o,u)}return super.load(t,r,i,s)}}function Pt(e){const t=e+"BufferGeometry";return l.exports.forwardRef((o,r)=>{var u=o,{args:n,children:i}=u,s=V(u,["args","children"]);return l.exports.createElement("mesh",je({ref:r},s),l.exports.createElement(t,{attach:"geometry",args:n}),i)})}const It=Pt("icosahedron"),_e={sunset:"venice/venice_sunset_1k.hdr",dawn:"kiara/kiara_1_dawn_1k.hdr",night:"dikhololo/dikhololo_night_1k.hdr",warehouse:"empty-wharehouse/empty_warehouse_01_1k.hdr",forest:"forrest-slope/forest_slope_1k.hdr",apartment:"lebombo/lebombo_1k.hdr",studio:"studio-small-3/studio_small_03_1k.hdr",city:"potsdamer-platz/potsdamer_platz_1k.hdr",park:"rooitou/rooitou_park_1k.hdr",lobby:"st-fagans/st_fagans_interior_1k.hdr"};var Ft=`#define GLSLIFY 1
varying vec3 vWorldPosition;void main(){vec4 worldPosition=modelMatrix*vec4(position,1.0);vWorldPosition=worldPosition.xyz;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}`,Nt=`#define GLSLIFY 1
#define ENVMAP_TYPE_CUBE_UV
varying vec3 vWorldPosition;uniform float radius;uniform float height;
#ifdef ENVMAP_TYPE_CUBE
uniform samplerCube cubemap;
#else
uniform sampler2D cubemap;
#endif
float diskIntersect(in vec3 ro,in vec3 rd,vec3 c,vec3 n,float r){vec3 o=ro-c;float t=-dot(n,o)/dot(rd,n);vec3 q=o+rd*t;return(dot(q,q)<r*r)? t : 1e6;}float sphereIntersect(in vec3 ro,in vec3 rd,in vec3 ce,float ra){vec3 oc=ro-ce;float b=dot(oc,rd);float c=dot(oc,oc)-ra*ra;float h=b*b-c;if(h<0.0)-1.0;h=sqrt(h);return-b+h;}vec3 project(){vec3 p=normalize(vWorldPosition);vec3 camPos=cameraPosition;camPos.y-=height;float intersection=sphereIntersect(camPos,p,vec3(0.),radius);if(intersection>0.){vec3 h=vec3(0.0,-height,0.0);float intersection2=diskIntersect(camPos,p,h,vec3(0.0,-1.0,0.0),radius);p=(camPos+min(intersection,intersection2)*p)/radius;}else{p=vec3(0.0,1.0,0.0);}return p;}
#include <common>
#include <cube_uv_reflection_fragment>
void main(){vec3 projectedWorldPosition=project();
#ifdef ENVMAP_TYPE_CUBE
vec3 outcolor=textureCube(cubemap,projectedWorldPosition).rgb;
#else
vec3 direction=normalize(projectedWorldPosition);vec2 uv=equirectUv(direction);vec3 outcolor=texture2D(cubemap,uv).rgb;
#endif
gl_FragColor=vec4(outcolor,1.0);
#include <tonemapping_fragment>
#include <encodings_fragment>
}`;const Lt="https://market-assets.fra1.cdn.digitaloceanspaces.com/market-assets/hdris/",Ut=e=>e&&e.isCubeTexture,Ot=e=>e.current&&e.current.isScene,Pe=e=>Ot(e)?e.current:e;function Ie({scene:e,background:t=!1,map:n}){const i=ne(s=>s.scene);return l.exports.useLayoutEffect(()=>{if(n){const s=Pe(e||i),r=s.background,o=s.environment;return t!=="only"&&(s.environment=n),t&&(s.background=n),()=>{t!=="only"&&(s.environment=o),t&&(s.background=r)}}},[i,e,n,t]),null}function Ke({files:e=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"],path:t="",preset:n=void 0,extensions:i}){if(n){if(!(n in _e))throw new Error("Preset must be one of: "+Object.keys(_e).join(", "));e=_e[n],t=Lt}const s=Array.isArray(e),o=ct(s?lt:Dt,s?[e]:e,h=>{h.setPath(t),i&&i(h)}),u=s?o[0]:o;return u.mapping=s?ht:dt,u}function Ze(i){var s=i,{background:e=!1,scene:t}=s,n=V(s,["background","scene"]);const r=Ke(n),o=ne(u=>u.scene);return l.exports.useLayoutEffect(()=>{const u=Pe(t||o),h=u.background,p=u.environment;return e!=="only"&&(u.environment=r),e&&(u.background=r),()=>{e!=="only"&&(u.environment=p),e&&(u.background=h)}},[r,e,t,o]),null}function kt({children:e,near:t=1,far:n=1e3,resolution:i=256,frames:s=1,map:r,background:o=!1,scene:u,files:h,path:p,preset:b=void 0,extensions:E}){const g=ne(d=>d.gl),A=ne(d=>d.scene),C=l.exports.useRef(null),[w]=l.exports.useState(()=>new me),P=l.exports.useMemo(()=>{const d=new ot(i);return d.texture.type=te,d},[i]);l.exports.useLayoutEffect(()=>{s===1&&C.current.update(g,w);const d=Pe(u||A),c=d.background,v=d.environment;return o!=="only"&&(d.environment=P.texture),o&&(d.background=P.texture),()=>{o!=="only"&&(d.environment=v),o&&(d.background=c)}},[e,w,P.texture,u,A,o,s,g]);let M=1;return Me(()=>{(s===1/0||M<s)&&(C.current.update(g,w),M++)}),l.exports.createElement(l.exports.Fragment,null,ut(l.exports.createElement(l.exports.Fragment,null,e,l.exports.createElement("cubeCamera",{ref:C,args:[t,n,P]}),h||b?l.exports.createElement(Ze,{background:!0,files:h,preset:b,path:p,extensions:E}):r?l.exports.createElement(Ie,{background:!0,map:r,extensions:E}):null),w))}function zt(e){var t,n,i,s;const r=Ke(e),o=e.map||r,u=Ut(o),h=l.exports.useMemo(()=>{var w,P;const d=((w=u?(P=o.image[0])==null?void 0:P.width:o.image.width)!==null&&w!==void 0?w:1024)/4,c=Math.floor(Math.log2(d)),v=Math.pow(2,c),_=3*Math.max(v,16*7),S=4*v;return[u?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/_}`,`#define CUBEUV_TEXEL_HEIGHT ${1/S}`,`#define CUBEUV_MAX_MIP ${c}.0`,""]},[]),p=l.exports.useMemo(()=>h.join(`
`)+Nt,[h]),b=l.exports.useMemo(()=>({cubemap:{value:null},height:{value:15},radius:{value:60}}),[]),E=l.exports.useRef(null),g=(t=e.ground)==null?void 0:t.height,A=(n=e.ground)==null?void 0:n.radius,C=(i=(s=e.ground)==null?void 0:s.scale)!==null&&i!==void 0?i:1e3;return l.exports.useEffect(()=>void(g&&(E.current.uniforms.height.value=g)),[g]),l.exports.useEffect(()=>void(A&&(E.current.uniforms.radius.value=A)),[A]),l.exports.useEffect(()=>void(E.current.uniforms.cubemap.value=o),[o]),l.exports.createElement(l.exports.Fragment,null,l.exports.createElement(Ie,je({},e,{map:o})),l.exports.createElement(It,{scale:C,args:[1,16]},l.exports.createElement("shaderMaterial",{ref:E,side:pe,vertexShader:Ft,fragmentShader:p,uniforms:b,depthTest:!1})))}function Gt(e){return e.ground?l.exports.createElement(zt,e):e.map?l.exports.createElement(Ie,e):e.children?l.exports.createElement(kt,e):l.exports.createElement(Ze,e)}class Ht extends ee{constructor(){super({uniforms:{time:{value:0},fade:{value:1}},vertexShader:`
      uniform float time;
      attribute float size;
      varying vec3 vColor;
      void main() {
        vColor = color;
        vec4 mvPosition = modelViewMatrix * vec4(position, 0.5);
        gl_PointSize = size * (30.0 / -mvPosition.z) * (3.0 + sin(mvPosition.x + 2.0 * time + 100.0));
        gl_Position = projectionMatrix * mvPosition;
      }`,fragmentShader:`
      uniform sampler2D pointTexture;
      uniform float fade;
      varying vec3 vColor;
      void main() {
        float opacity = 1.0;
        if (fade == 1.0) {
          float d = distance(gl_PointCoord, vec2(0.5, 0.5));
          opacity = 1.0 / (1.0 + exp(16.0 * (d - 0.25)));
        }
        gl_FragColor = vec4(vColor, opacity);

        #include <tonemapping_fragment>
	      #include <encodings_fragment>
      }`})}}const Vt=e=>new re().setFromSpherical(new ft(e,Math.acos(1-Math.random()*2),Math.random()*2*Math.PI)),$e=l.exports.forwardRef(({radius:e=100,depth:t=50,count:n=5e3,saturation:i=0,factor:s=4,fade:r=!1,speed:o=1},u)=>{const h=l.exports.useRef(),[p,b,E]=l.exports.useMemo(()=>{const A=[],C=[],w=Array.from({length:n},()=>(.5+.5*Math.random())*s),P=new Se;let M=e+t;const d=t/n;for(let c=0;c<n;c++)M-=d*Math.random(),A.push(...Vt(M).toArray()),P.setHSL(c/n,i,.9),C.push(P.r,P.g,P.b);return[new Float32Array(A),new Float32Array(C),new Float32Array(w)]},[n,t,s,e,i]);Me(A=>h.current&&(h.current.uniforms.time.value=A.clock.getElapsedTime()*o));const[g]=l.exports.useState(()=>new Ht);return l.exports.createElement("points",{ref:u},l.exports.createElement("bufferGeometry",null,l.exports.createElement("bufferAttribute",{attach:"attributes-position",args:[p,3]}),l.exports.createElement("bufferAttribute",{attach:"attributes-color",args:[b,3]}),l.exports.createElement("bufferAttribute",{attach:"attributes-size",args:[E,1]})),l.exports.createElement("primitive",{ref:h,object:g,attach:"material",blending:pt,"uniforms-fade-value":r,transparent:!0,vertexColors:!0}))});function Wt(t){var e=V(t,[]);const n=l.exports.useRef(),i=l.exports.useRef(null),{nodes:s,materials:r}=O("/three-playground/black_leather_chair.glb");return l.exports.useEffect(()=>{if(i.current===null)return;ye.timeline().to(i.current.rotation,{duration:1,delay:.1,ease:"Expo.easeInOut",x:0,y:Math.PI/2,z:0}).to(i.current.rotation,{duration:1,ease:"Expo.easeInOut",x:0,y:Math.PI,z:0}).to(i.current.rotation,{duration:1,ease:"Expo.easeInOut",x:0,y:Math.PI*3/2,z:0}).to(i.current.rotation,{duration:1,ease:"Expo.easeInOut",x:0,y:Math.PI*2,z:0}).to(i.current.rotation,{duration:2,ease:"Expo.easeInOut",x:0,y:.5,z:0})},[i]),a("group",Q(q({ref:n},e),{dispose:null,scale:e.scale,children:a("mesh",{geometry:s.koltuk.geometry,material:r.chair,rotation:[0,Math.PI/2,0],ref:i})}))}O.preload("/black_leather_chair.glb");function jt(){const e=l.exports.useRef(null);return D(ae,{className:"w-full h-full cursor-grab",children:[a(oe,{makeDefault:!0,position:[3,.5,0],ref:e,zoom:1}),a(ue,{enablePan:!0,enableZoom:!1,enableRotate:!0}),a(we,{position:[10,10,10]}),a(Wt,{scale:[2,2,2],position:[0,-.8,0]})]})}function Xt(){return a("div",{id:"firstView",className:"h-screen flex justify-center items-center bg-gray-300",children:D("div",{className:"w-4/5 h-full",children:[D("h1",{className:"text-center font-bold py-2 text-[200px] absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 leading-[1] break-words",children:["THREE ",a("br",{}),"PLAYGROUND"]}),a("p",{className:"absolute bottom-[10vh] right-[10vw] px-4 bg-white rounded-full",children:"\u{1F44B} drag me"}),a(l.exports.Suspense,{fallback:a("p",{className:"text-center",children:"loading now..."}),children:a("div",{className:"absolute top-0 left-0 w-full h-full",children:a(jt,{})})})]})})}function Yt(t){var e=V(t,[]);const n=l.exports.useRef(),{nodes:i,materials:s}=O("/three-playground/cushion.glb");return a("group",Q(q({ref:n},e),{dispose:null,children:a("group",{rotation:[-Math.PI/2,0,0],scale:.01,children:a("group",{rotation:[Math.PI/2,0,0],children:a("group",{position:[0,40.99,0],scale:43.31,children:a("mesh",{geometry:i.Object_6.geometry,material:s.Base})})})})}))}O.preload("/cushion.glb");function Kt(){return D(ae,{className:"w-full h-full",children:[a(oe,{makeDefault:!0,position:[0,0,-10]}),a(ue,{enablePan:!0,enableZoom:!0,enableRotate:!0}),a(we,{position:[10,10,10]}),a(Yt,{scale:[4,4,4],position:[0,-2,0],rotation:[-.4,3,0]})]})}function Zt(){return D("div",{id:"section1",className:"h-screen w-full bg-black text-white flex items-center justify-between",children:[D("div",{className:"w-1/2 p-[7%]",children:[a("h2",{className:"font-bold text-36",children:"section1"}),a("h3",{className:"mb-10 font-bold text-14",children:"section1 headline text"}),a("p",{children:"\u53CB\u4EBA\u30B7\u30E3\u30FC\u30ED\u30C3\u30AF\u30FB\u30DB\u30FC\u30E0\u30BA\u306E\u3082\u3068\u3092\u3001\u79C1\u306F\u30AF\u30EA\u30B9\u30DE\u30B9\u306E\u4E8C\u65E5\u5F8C\u306B\u8A2A\u308C\u305F\u3002\u6642\u5019\u306E\u6328\u62F6\u3092\u3057\u3088\u3046\u3068\u601D\u3063\u305F\u306E\u3060\u3002\u30DB\u30FC\u30E0\u30BA\u306F\u7D2B\u306E\u5316\u7CA7\u7740\u59FF\u3067\u3001\u30BD\u30D5\u30A1\u306B\u304F\u3064\u308D\u3044\u3067\u3044\u305F\u3002\u53F3\u624B\u306E\u5C4A\u304F\u3068\u3053\u308D\u306B\u30D1\u30A4\u30D7\u7F6E\u304D\u304C\u3042\u308A\u3001\u4ECA\u8AAD\u3093\u3067\u3044\u308B\u3068\u3053\u308D\u306A\u306E\u3060\u308D\u3046\u3001\u624B\u5143\u306B\u306F\u3050\u3061\u3083\u308A\u3068\u671D\u520A\u306E\u5C71\u304C\u7A4D\u307E\u308C\u3066\u3044\u308B\u3002\u30BD\u30D5\u30A1\u306E\u305D\u3070\u306B\u306F\u6728\u306E\u6905\u5B50\u304C\u3042\u308A\u3001\u80CC\u306E\u89D2\u306B\u3061\u3087\u3046\u3069\u3001\u8DA3\u5473\u306E\u60AA\u3044\u5805\u3081\u306E\u30D5\u30A7\u30EB\u30C8\u5E3D\u304C\u3072\u3063\u304B\u3051\u3089\u308C\u3066\u3044\u305F\u3002\u305A\u3044\u3076\u3093\u304F\u305F\u3073\u308C\u3066\u3044\u3066\u3001\u4F55\u30F6\u6240\u304B\u7834\u308C\u3066\u3057\u307E\u3063\u3066\u3044\u308B\u3002\u5EA7\u308B\u5834\u6240\u306B\u62E1\u5927\u93E1\u3068\u30D4\u30F3\u30BB\u30C3\u30C8\u304C\u3042\u3063\u305F\u306E\u3067\u3001\u5E3D\u5B50\u304C\u3053\u3093\u306A\u3075\u3046\u306B\u3064\u308B\u3055\u308C\u3066\u3044\u308B\u306E\u306F\u3001\u4F55\u304B\u8ABF\u3079\u308B\u305F\u3081\u306A\u306E\u3060\u308D\u3046\u3002"})]}),D("div",{className:"relative overflow-hidden h-full flex items-center",children:[a("div",{className:"bg-white rounded-full w-[50vw] h-[50vw] translate-x-20"}),a(l.exports.Suspense,{fallback:a("p",{className:"text-center",children:"loading now..."}),children:a("div",{className:"absolute top-0 left-0 w-full h-full",children:a(Kt,{})})})]})]})}function $t(t){var e=V(t,[]);const n=l.exports.useRef(),{nodes:i,materials:s}=O("/three-playground/dublin.glb");return a("group",Q(q({ref:n},e),{dispose:null,children:a("group",{rotation:[-Math.PI/2,0,0],children:D("group",{rotation:[Math.PI/2,0,0],children:[D("group",{position:[53.23,-.51,-32.39],rotation:[-Math.PI/2,0,0],scale:2.54,children:[a("group",{position:[-8.19,-11.26,-5.5],children:a("group",{position:[2.83,11.07,6.58],rotation:[-Math.PI/2,0,Math.PI],children:a("mesh",{geometry:i.legs_metal_Leg_0.geometry,material:s.metal_Leg})})}),a("group",{position:[-11.54,-11.26,-21.91],children:a("group",{position:[6.17,11.07,22.98],rotation:[-Math.PI/2,0,Math.PI],children:a("mesh",{geometry:i.leatherChair_leather_white_0.geometry,material:s.leather_white})})})]}),D("group",{position:[-42.87,-.51,43.05],rotation:[-Math.PI/2,0,-1.92],scale:2.54,children:[a("group",{position:[-11.54,-11.26,-21.91],children:a("group",{position:[6.17,11.07,22.98],rotation:[-Math.PI/2,0,Math.PI],children:a("mesh",{geometry:i.leatherChair001_leather_dark_0.geometry,material:s.leather_dark})})}),a("group",{position:[-8.19,-11.26,-5.5],children:a("group",{position:[2.83,11.07,6.58],rotation:[-Math.PI/2,0,Math.PI],children:a("mesh",{geometry:i.legs001_metal_Leg_0.geometry,material:s.metal_Leg})})})]})]})})}))}O.preload("/dublin.glb");function qt(){return D(ae,{className:"w-full h-full",children:[a(oe,{makeDefault:!0,position:[0,500,-1e3]}),a(ue,{enablePan:!0,enableZoom:!1,enableRotate:!0}),a(we,{position:[1e3,20,-100]}),a($t,{scale:[3,3,3],position:[0,0,0]})]})}function Qt(){return D("div",{id:"section2",className:"h-screen w-full flex items-center justify-between bg-gray-200",children:[D("div",{className:"relative w-1/2 overflow-hidden h-full flex",children:[a("div",{className:"flex items-center justify-start",children:D("span",{className:"uppercase text-[12vw] w-full text-white leading-[1.2] font-bold",children:["play",a("br",{}),"like",a("br",{}),"a child"]})}),a(l.exports.Suspense,{fallback:a("p",{className:"text-center",children:"loading now..."}),children:a("div",{className:"absolute top-0 left-0 w-full h-full",children:a(qt,{})})})]}),D("div",{className:"w-1/2 p-[7%] pt-[14%]",children:[a("h2",{className:"font-bold text-36",children:"section2"}),a("h3",{className:"mb-10 font-bold text-14",children:"section1 headline text"}),a("p",{children:"\u53CB\u4EBA\u30B7\u30E3\u30FC\u30ED\u30C3\u30AF\u30FB\u30DB\u30FC\u30E0\u30BA\u306E\u3082\u3068\u3092\u3001\u79C1\u306F\u30AF\u30EA\u30B9\u30DE\u30B9\u306E\u4E8C\u65E5\u5F8C\u306B\u8A2A\u308C\u305F\u3002\u6642\u5019\u306E\u6328\u62F6\u3092\u3057\u3088\u3046\u3068\u601D\u3063\u305F\u306E\u3060\u3002\u30DB\u30FC\u30E0\u30BA\u306F\u7D2B\u306E\u5316\u7CA7\u7740\u59FF\u3067\u3001\u30BD\u30D5\u30A1\u306B\u304F\u3064\u308D\u3044\u3067\u3044\u305F\u3002\u53F3\u624B\u306E\u5C4A\u304F\u3068\u3053\u308D\u306B\u30D1\u30A4\u30D7\u7F6E\u304D\u304C\u3042\u308A\u3001\u4ECA\u8AAD\u3093\u3067\u3044\u308B\u3068\u3053\u308D"})]})]})}/**
 * postprocessing v6.26.3 build Thu Mar 24 2022
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2022 Raoul van Rüschen
 * @license Zlib
 */var Jt=`#include <packing>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
uniform lowp sampler2D luminanceBuffer0;uniform lowp sampler2D luminanceBuffer1;uniform float minLuminance;uniform float deltaTime;uniform float tau;varying vec2 vUv;void main(){float l0=unpackRGBAToFloat(texture2D(luminanceBuffer0,vUv));
#if __VERSION__ < 300
float l1=texture2DLodEXT(luminanceBuffer1,vUv,MIP_LEVEL_1X1).r;
#else
float l1=textureLod(luminanceBuffer1,vUv,MIP_LEVEL_1X1).r;
#endif
l0=max(minLuminance,l0);l1=max(minLuminance,l1);float adaptedLum=l0+(l1-l0)*(1.0-exp(-deltaTime*tau));gl_FragColor=(adaptedLum==1.0)?vec4(1.0):packFloatToRGBA(adaptedLum);}`,Fe="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",en=class extends ee{constructor(){super({name:"AdaptiveLuminanceMaterial",defines:{MIP_LEVEL_1X1:"0.0"},uniforms:{luminanceBuffer0:new f(null),luminanceBuffer1:new f(null),minLuminance:new f(.01),deltaTime:new f(0),tau:new f(1)},extensions:{shaderTextureLOD:!0},blending:ce,depthWrite:!1,depthTest:!1,fragmentShader:Jt,vertexShader:Fe}),this.toneMapped=!1}set luminanceBuffer0(e){this.uniforms.luminanceBuffer0.value=e}setLuminanceBuffer0(e){this.uniforms.luminanceBuffer0.value=e}set luminanceBuffer1(e){this.uniforms.luminanceBuffer1.value=e}setLuminanceBuffer1(e){this.uniforms.luminanceBuffer1.value=e}set mipLevel1x1(e){this.defines.MIP_LEVEL_1X1=e.toFixed(1),this.needsUpdate=!0}setMipLevel1x1(e){this.mipLevel1x1=e}set deltaTime(e){this.uniforms.deltaTime.value=e}setDeltaTime(e){this.uniforms.deltaTime.value=e}get minLuminance(){return this.uniforms.minLuminance.value}set minLuminance(e){this.uniforms.minLuminance.value=e}getMinLuminance(){return this.uniforms.minLuminance.value}setMinLuminance(e){this.uniforms.minLuminance.value=e}get adaptationRate(){return this.uniforms.tau.value}set adaptationRate(e){this.uniforms.tau.value=e}getAdaptationRate(){return this.uniforms.tau.value}setAdaptationRate(e){this.uniforms.tau.value=e}},tn=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <encodings_fragment>
#include <dithering_fragment>
}`,nn="uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",Ge=class extends ee{constructor(e=new I){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new f(null),texelSize:new f(new I),halfTexelSize:new f(new I),kernel:new f(0),scale:new f(1)},blending:ce,depthWrite:!1,depthTest:!1,fragmentShader:tn,vertexShader:nn}),this.toneMapped=!1,this.setTexelSize(e.x,e.y)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.inputBuffer=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(){return this.uniforms.scale.value}setScale(e){this.uniforms.scale.value=e}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(e){this.uniforms.kernel.value=e}setKernel(e){this.kernel=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setSize(e,t){const n=this.uniforms;n.texelSize.value.set(1/e,1/t),n.halfTexelSize.value.copy(n.texelSize.value).multiplyScalar(.5)}},sn=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <encodings_fragment>
}`,rn=class extends ee{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new f(null),opacity:new f(1)},blending:ce,depthWrite:!1,depthTest:!1,fragmentShader:sn,vertexShader:Fe}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}},an=`#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
#ifdef DOWNSAMPLE_NORMALS
uniform lowp sampler2D normalBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}int findBestDepth(const in float samples[4]){float c=(samples[0]+samples[1]+samples[2]+samples[3])/4.0;float distances[4];distances[0]=abs(c-samples[0]);distances[1]=abs(c-samples[1]);distances[2]=abs(c-samples[2]);distances[3]=abs(c-samples[3]);float maxDistance=max(max(distances[0],distances[1]),max(distances[2],distances[3]));int remaining[3];int rejected[3];int i,j,k;for(i=0,j=0,k=0;i<4;++i){if(distances[i]<maxDistance){remaining[j++]=i;}else{rejected[k++]=i;}}for(;j<3;++j){remaining[j]=rejected[--k];}vec3 s=vec3(samples[remaining[0]],samples[remaining[1]],samples[remaining[2]]);c=(s.x+s.y+s.z)/3.0;distances[0]=abs(c-s.x);distances[1]=abs(c-s.y);distances[2]=abs(c-s.z);float minDistance=min(distances[0],min(distances[1],distances[2]));for(i=0;i<3;++i){if(distances[i]==minDistance){break;}}return remaining[i];}void main(){float d[4];d[0]=readDepth(vUv0);d[1]=readDepth(vUv1);d[2]=readDepth(vUv2);d[3]=readDepth(vUv3);int index=findBestDepth(d);
#ifdef DOWNSAMPLE_NORMALS
vec2 uvs[4];uvs[0]=vUv0;uvs[1]=vUv1;uvs[2]=vUv2;uvs[3]=vUv3;vec3 n=texture2D(normalBuffer,uvs[index]).rgb;
#else
vec3 n=vec3(0.0);
#endif
gl_FragColor=vec4(n,d[index]);}`,on="uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=uv;vUv1=vec2(uv.x,uv.y+texelSize.y);vUv2=vec2(uv.x+texelSize.x,uv.y);vUv3=uv+texelSize;gl_Position=vec4(position.xy,1.0,1.0);}",un=class extends ee{constructor(){super({name:"DepthDownsamplingMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new f(null),normalBuffer:new f(null),texelSize:new f(new I)},blending:ce,depthWrite:!1,depthTest:!1,fragmentShader:an,vertexShader:on}),this.toneMapped=!1}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=le){this.depthBuffer=e,this.depthPacking=t}set normalBuffer(e){this.uniforms.normalBuffer.value=e,e!==null?this.defines.DOWNSAMPLE_NORMALS="1":delete this.defines.DOWNSAMPLE_NORMALS,this.needsUpdate=!0}setNormalBuffer(e){this.normalBuffer=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},ln=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;
#if THREE_REVISION >= 137
vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <encodings_fragment>
#endif
#include <dithering_fragment>
}`,cn="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}",G={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},Ce=class extends ee{constructor(e,t,n,i,s=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:Xe.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new f(null),depthBuffer:new f(null),resolution:new f(new I),texelSize:new f(new I),cameraNear:new f(.3),cameraFar:new f(1e3),aspect:new f(1),time:new f(0)},blending:ce,depthWrite:!1,depthTest:!1,dithering:s}),this.toneMapped=!1,e&&this.setShaderParts(e),t&&this.setDefines(t),n&&this.setUniforms(n),this.adoptCameraSettings(i)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=le){this.depthBuffer=e,this.depthPacking=t}setShaderParts(e){return this.fragmentShader=ln.replace(G.FRAGMENT_HEAD,e.get(G.FRAGMENT_HEAD)).replace(G.FRAGMENT_MAIN_UV,e.get(G.FRAGMENT_MAIN_UV)).replace(G.FRAGMENT_MAIN_IMAGE,e.get(G.FRAGMENT_MAIN_IMAGE)),this.vertexShader=cn.replace(G.VERTEX_HEAD,e.get(G.VERTEX_HEAD)).replace(G.VERTEX_MAIN_SUPPORT,e.get(G.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(e){for(const t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(const t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(const t of e)this.extensions[t]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof St?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){const n=this.uniforms;n.resolution.value.set(e,t),n.texelSize.value.set(1/e,1/t),n.aspect.value=e/t}static get Section(){return G}},hn=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=linearToRelativeLuminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*l,l);
#else
gl_FragColor=vec4(l);
#endif
}`,dn=class extends ee{constructor(e=!1,t=null){super({name:"LuminanceMaterial",uniforms:{inputBuffer:new f(null),threshold:new f(0),smoothing:new f(1),range:new f(null)},blending:ce,depthWrite:!1,depthTest:!1,fragmentShader:hn,vertexShader:Fe}),this.toneMapped=!1,this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return this.luminanceRange!==null}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){e!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}},fn=new mt,Z=null;function pn(){if(Z===null){const e=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]);Z=new Rt,Z.setAttribute!==void 0?(Z.setAttribute("position",new xe(e,3)),Z.setAttribute("uv",new xe(t,2))):(Z.addAttribute("position",new xe(e,3)),Z.addAttribute("uv",new xe(t,2)))}return Z}var H=class{constructor(e="Pass",t=new me,n=fn){this.name=e,this.renderer=null,this.scene=t,this.camera=n,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const t=this.getFullscreenMaterial();t!==null&&(t.needsUpdate=!0),this.rtt=!e}}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new wt(pn(),e),t.frustumCulled=!1,this.scene===null&&(this.scene=new me),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=le){}render(e,t,n,i,s){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,n){}dispose(){for(const e of Object.keys(this)){const t=this[e];if(t!==null&&typeof t.dispose=="function"){if(t instanceof me||t===this.renderer)continue;this[e].dispose()}}}},qe=class extends H{constructor(e,t=!0){super("CopyPass"),this.fullscreenMaterial=new rn,this.needsSwap=!1,this.renderTarget=e,e===void 0&&(this.renderTarget=new W(1,1,{minFilter:N,magFilter:N,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,n,i,s){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,n){n!==void 0&&(this.renderTarget.texture.type=n,n!==se?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":e.outputEncoding===U&&(this.renderTarget.texture.encoding=U))}},mn=class extends H{constructor(e,{minLuminance:t=.01,adaptationRate:n=1}={}){super("AdaptiveLuminancePass"),this.fullscreenMaterial=new en,this.needsSwap=!1,this.renderTargetPrevious=new W(1,1,{minFilter:ie,magFilter:ie,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetPrevious.texture.name="Luminance.Previous";const i=this.fullscreenMaterial;i.luminanceBuffer0=this.renderTargetPrevious.texture,i.luminanceBuffer1=e,i.minLuminance=t,i.adaptationRate=n,this.renderTargetAdapted=this.renderTargetPrevious.clone(),this.renderTargetAdapted.texture.name="Luminance.Adapted",this.copyPass=new qe(this.renderTargetPrevious,!1)}get texture(){return this.renderTargetAdapted.texture}getTexture(){return this.renderTargetAdapted.texture}set mipLevel1x1(e){this.fullscreenMaterial.mipLevel1x1=e}get adaptationRate(){return this.fullscreenMaterial.adaptationRate}set adaptationRate(e){this.fullscreenMaterial.adaptationRate=e}render(e,t,n,i,s){this.fullscreenMaterial.deltaTime=i,e.setRenderTarget(this.renderToScreen?null:this.renderTargetAdapted),e.render(this.scene,this.camera),this.copyPass.render(e,this.renderTargetAdapted)}},gn=class extends H{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,n,i,s){const r=e.state.buffers.stencil;r.setLocked(!1),r.setTest(!1)}},Re=new Se,Qe=class extends H{constructor(e=!0,t=!0,n=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=n,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,n){this.color=e,this.depth=t,this.stencil=n}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,n,i,s){const r=this.overrideClearColor,o=this.overrideClearAlpha,u=e.getClearAlpha(),h=r!==null,p=o>=0;h?(Re.copy(e.getClearColor(Re)),e.setClearColor(r,p?o:u)):p&&e.setClearAlpha(o),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),h?e.setClearColor(Re,u):p&&e.setClearAlpha(u)}},$=-1,L=class extends De{constructor(e,t=$,n=$,i=1){super(),this.resizable=e,this.base=new I(1,1),this.preferred=new I(t,n),this.target=this.preferred,this.s=i}get width(){const{base:e,preferred:t,scale:n}=this;let i;return t.width!==$?i=t.width:t.height!==$?i=Math.round(t.height*(e.width/Math.max(e.height,1))):i=Math.round(e.width*n),i}set width(e){this.preferredWidth=e}get height(){const{base:e,preferred:t,scale:n}=this;let i;return t.height!==$?i=t.height:t.width!==$?i=Math.round(t.width/Math.max(e.width/Math.max(e.height,1),1)):i=Math.round(e.height*n),i}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferred.setScalar($),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.base.width}set baseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseWidth(){return this.base.width}setBaseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get baseHeight(){return this.base.height}set baseHeight(e){this.base.height!==e&&(this.base.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){(this.base.width!==e||this.base.height!==t)&&(this.base.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get preferredWidth(){return this.preferred.width}set preferredWidth(e){this.preferred.width!==e&&(this.preferred.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferred.height}set preferredHeight(e){this.preferred.height!==e&&(this.preferred.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){(this.preferred.width!==e||this.preferred.height!==t)&&(this.preferred.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}copy(e){this.base.set(e.getBaseWidth(),e.getBaseHeight()),this.preferred.set(e.getPreferredWidth(),e.getPreferredHeight()),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height)}static get AUTO_SIZE(){return $}},Ae=!1,He=class{constructor(e=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=t=>{if(t.isMesh){let n;if(t.material.flatShading)switch(t.material.side){case Ee:n=this.materialsFlatShadedDoubleSide;break;case pe:n=this.materialsFlatShadedBackSide;break;default:n=this.materialsFlatShaded;break}else switch(t.material.side){case Ee:n=this.materialsDoubleSide;break;case pe:n=this.materialsBackSide;break;default:n=this.materials;break}this.originalMaterials.set(t,t.material),t.isSkinnedMesh?t.material=n[2]:t.isInstancedMesh?t.material=n[1]:t.material=n[0],++this.meshCount}}}setMaterial(e){if(this.disposeMaterials(),this.material=e,e!==null){const t=this.materials=[e.clone(),e.clone(),e.clone()];for(const n of t)n.uniforms=Object.assign({},e.uniforms),n.side=_t;t[2].skinning=!0,this.materialsBackSide=t.map(n=>{const i=n.clone();return i.uniforms=Object.assign({},e.uniforms),i.side=pe,i}),this.materialsDoubleSide=t.map(n=>{const i=n.clone();return i.uniforms=Object.assign({},e.uniforms),i.side=Ee,i}),this.materialsFlatShaded=t.map(n=>{const i=n.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i}),this.materialsFlatShadedBackSide=t.map(n=>{const i=n.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=pe,i}),this.materialsFlatShadedDoubleSide=t.map(n=>{const i=n.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=Ee,i})}}render(e,t,n){const i=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,Ae){const s=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,n);for(const r of s)r[0].material=r[1];this.meshCount!==s.size&&s.clear()}else{const s=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,n),t.overrideMaterial=s}e.shadowMap.enabled=i}disposeMaterials(){if(this.material!==null){const e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return Ae}static set workaroundEnabled(e){Ae=e}},Je=class extends H{constructor(e,t,n=null){super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new Qe,this.overrideMaterialManager=n===null?null:new He(n),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){const e=this.overrideMaterialManager;return e!==null?e.material:null}set overrideMaterial(e){const t=this.overrideMaterialManager;e!==null?t!==null?t.setMaterial(e):this.overrideMaterialManager=new He(e):t!==null&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,n,i,s){const r=this.scene,o=this.camera,u=this.selection,h=o.layers.mask,p=r.background,b=e.shadowMap.autoUpdate,E=this.renderToScreen?null:t;u!==null&&o.layers.set(u.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(r.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(E),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(e,r,o):e.render(r,o),o.layers.mask=h,r.background=p,e.shadowMap.autoUpdate=b}},vn=class extends H{constructor({normalBuffer:e=null,resolutionScale:t=.5,width:n=L.AUTO_SIZE,height:i=L.AUTO_SIZE}={}){super("DepthDownsamplingPass");const s=new un;s.normalBuffer=e,this.fullscreenMaterial=s,this.needsDepthTexture=!0,this.needsSwap=!1,this.renderTarget=new W(1,1,{minFilter:ie,magFilter:ie,stencilBuffer:!1,depthBuffer:!1,type:Te}),this.renderTarget.texture.name="DepthDownsamplingPass.Target",this.renderTarget.texture.generateMipmaps=!1;const r=this.resolution=new L(this,n,i,t);r.addEventListener("change",o=>this.setSize(r.baseWidth,r.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}setDepthTexture(e,t=le){this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t}render(e,t,n,i,s){e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.fullscreenMaterial.setSize(e,t);const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height)}initialize(e,t,n){e.capabilities.isWebGL2||console.error("The DepthDownsamplingPass requires WebGL 2")}},x={SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18},En="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}",xn="vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}",bn="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}",Tn="float blend(const in float x,const in float y){return(y==0.0)?y:max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",yn="float blend(const in float x,const in float y){return(y==1.0)?y:min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Mn="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}",Sn="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}",wn="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}",_n="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}",Rn="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}",An="float blend(const in float x,const in float y){return(y>0.0)?min(x/y,1.0):1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Bn="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}",Cn="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}",Dn="float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Pn="float blend(const in float x,const in float y){return(y==1.0)?y:min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",In="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}",Fn="float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Nn="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}",Ln=new Map([[x.SKIP,null],[x.ADD,En],[x.ALPHA,xn],[x.AVERAGE,bn],[x.COLOR_BURN,Tn],[x.COLOR_DODGE,yn],[x.DARKEN,Mn],[x.DIFFERENCE,Sn],[x.EXCLUSION,wn],[x.LIGHTEN,_n],[x.MULTIPLY,Rn],[x.DIVIDE,An],[x.NEGATION,Bn],[x.NORMAL,Cn],[x.OVERLAY,Dn],[x.REFLECT,Pn],[x.SCREEN,In],[x.SOFT_LIGHT,Fn],[x.SUBTRACT,Nn]]),Un=class extends De{constructor(e,t=1){super(),this.f=e,this.opacity=new f(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this.f}set blendFunction(e){this.f=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return Ln.get(this.blendFunction)}},J={NONE:0,DEPTH:1,CONVOLUTION:2},k=class extends De{constructor(e,t,{attributes:n=J.NONE,blendFunction:i=x.SCREEN,defines:s=new Map,uniforms:r=new Map,extensions:o=null,vertexShader:u=null}={}){super(),this.name=e,this.renderer=null,this.attributes=n,this.fragmentShader=t,this.vertexShader=u,this.defines=s,this.uniforms=r,this.extensions=o,this.blendMode=new Un(i),this.blendMode.addEventListener("change",h=>this.setChanged())}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e,t=le){}update(e,t,n){}setSize(e,t){}initialize(e,t,n){}dispose(){for(const e of Object.keys(this)){const t=this[e];if(t!==null&&typeof t.dispose=="function"){if(t instanceof me||t===this.renderer)continue;this[e].dispose()}}}};function Ve(e,t,n){for(const i of t){const s="$1"+e+i.charAt(0).toUpperCase()+i.slice(1),r=new RegExp("([^\\.])(\\b"+i+"\\b)","g");for(const o of n.entries())o[1]!==null&&n.set(o[0],o[1].replace(r,s))}}function On(e,t,n,i,s,r,o){const u=new Map([["fragment",t.getFragmentShader()],["vertex",t.getVertexShader()]]),h=u.get("fragment")!==void 0&&/mainImage/.test(u.get("fragment")),p=u.get("fragment")!==void 0&&/mainUv/.test(u.get("fragment"));let b=[],E=[],g=!1,A=!1;if(u.get("fragment")===void 0)console.error("Missing fragment shader",t);else if(p&&(o&J.CONVOLUTION)!==0)console.error("Effects that transform UV coordinates are incompatible with convolution effects",t);else if(!h&&!p)console.error("The fragment shader contains neither a mainImage nor a mainUv function",t);else{const C=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,w=Ce.Section;if(p){const M=`	${e}MainUv(UV);
`;n.set(w.FRAGMENT_MAIN_UV,n.get(w.FRAGMENT_MAIN_UV)+M),g=!0}if(u.get("vertex")!==null&&/mainSupport/.test(u.get("vertex"))){let M=`	${e}MainSupport(`;M+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(u.get("vertex"))?`vUv);
`:`);
`,n.set(w.VERTEX_MAIN_SUPPORT,n.get(w.VERTEX_MAIN_SUPPORT)+M),b=b.concat([...u.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map(d=>d[1])),E=E.concat(b).concat([...u.get("vertex").matchAll(C)].map(d=>d[1]))}E=E.concat([...u.get("fragment").matchAll(C)].map(M=>M[1])),E=E.concat([...t.defines.keys()].map(M=>M.replace(/\([\w\s,]*\)/g,""))),E=E.concat([...t.uniforms.keys()]),t.uniforms.forEach((M,d)=>r.set(e+d.charAt(0).toUpperCase()+d.slice(1),M)),t.defines.forEach((M,d)=>s.set(e+d.charAt(0).toUpperCase()+d.slice(1),M)),Ve(e,E,s),Ve(e,E,u);const P=t.blendMode;if(i.set(P.blendFunction,P),h){const M=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;let d=`${e}MainImage(color0, UV, `;(o&J.DEPTH)!==0&&M.test(u.get("fragment"))&&(d+="depth, ",A=!0),d+=`color1);
	`;const c=e+"BlendOpacity";r.set(c,P.opacity),d+=`color0 = blend${P.blendFunction}(color0, color1, ${c});

	`,n.set(w.FRAGMENT_MAIN_IMAGE,n.get(w.FRAGMENT_MAIN_IMAGE)+d),d=`uniform float ${c};

`,n.set(w.FRAGMENT_HEAD,n.get(w.FRAGMENT_HEAD)+d)}n.set(w.FRAGMENT_HEAD,n.get(w.FRAGMENT_HEAD)+u.get("fragment")+`
`),u.get("vertex")!==null&&n.set(w.VERTEX_HEAD,n.get(w.VERTEX_HEAD)+u.get("vertex")+`
`)}return{varyings:b,transformedUv:g,readDepth:A}}var kn=class extends H{constructor(e,...t){super("EffectPass"),this.fullscreenMaterial=new Ce(null,null,null,e),this.effects=t.sort((n,i)=>i.attributes-n.attributes),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){const t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}verifyResources(){const e=this.renderer.capabilities;let t=Math.min(e.maxFragmentUniforms,e.maxVertexUniforms);this.uniformCount>t&&console.warn("The current rendering context doesn't support more than "+t+" uniforms, but "+this.uniformCount+" were defined"),t=e.maxVaryings,this.varyingCount>t&&console.warn("The current rendering context doesn't support more than "+t+" varyings, but "+this.varyingCount+" were defined")}updateMaterial(){const e=Ce.Section,t=new Map([[e.FRAGMENT_HEAD,""],[e.FRAGMENT_MAIN_UV,""],[e.FRAGMENT_MAIN_IMAGE,""],[e.VERTEX_HEAD,""],[e.VERTEX_MAIN_SUPPORT,""]]),n=new Map,i=new Map,s=new Map,r=new Set;let o=0,u=0,h=0,p=!1,b=!1;for(const g of this.effects)if(g.blendMode.blendFunction===x.SKIP)h|=g.getAttributes()&J.DEPTH;else if((h&g.getAttributes()&J.CONVOLUTION)!==0)console.error("Convolution effects cannot be merged",g);else{h|=g.getAttributes();const A="e"+o++,C=On(A,g,t,n,i,s,h);if(u+=C.varyings.length,p=p||C.transformedUv,b=b||C.readDepth,g.extensions!==null)for(const w of g.extensions)r.add(w)}const E=/\bblend\b/g;for(const g of n.values()){const A=g.getShaderCode().replace(E,`blend${g.blendFunction}`);t.set(e.FRAGMENT_HEAD,t.get(e.FRAGMENT_HEAD)+A+`
`)}if((h&J.DEPTH)!==0){if(b){const g=`float depth = readDepth(UV);

	`;t.set(e.FRAGMENT_MAIN_IMAGE,g+t.get(e.FRAGMENT_MAIN_IMAGE))}this.needsDepthTexture=this.getDepthTexture()===null}else this.needsDepthTexture=!1;if(p){const g=`vec2 transformedUv = vUv;
`;t.set(e.FRAGMENT_MAIN_UV,g+t.get(e.FRAGMENT_MAIN_UV)),i.set("UV","transformedUv")}else i.set("UV","vUv");t.forEach((g,A,C)=>C.set(A,g.trim().replace(/^#/,`
#`))),this.uniformCount=s.size,this.varyingCount=u,this.skipRendering=o===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderParts(t).setExtensions(r).setUniforms(s).setDefines(i)}recompile(){this.updateMaterial(),this.verifyResources()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e,t=le){this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(const n of this.effects)n.setDepthTexture(e,t)}render(e,t,n,i,s){for(const r of this.effects)r.update(e,t,i);if(!this.skipRendering||this.renderToScreen){const r=this.fullscreenMaterial;r.inputBuffer=t.texture,r.time+=i,e.setRenderTarget(this.renderToScreen?null:n),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(const n of this.effects)n.setSize(e,t)}initialize(e,t,n){this.renderer=e;for(const i of this.effects)i.initialize(e,t,n),i.addEventListener("change",s=>this.handleEvent(s));this.updateMaterial(),this.verifyResources(),n!==void 0&&n!==se&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const e of this.effects)e.dispose()}handleEvent(e){switch(e.type){case"change":this.recompile();break}}},zn=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],Gn=class extends H{constructor({resolutionScale:e=.5,width:t=L.AUTO_SIZE,height:n=L.AUTO_SIZE,kernelSize:i=tt.LARGE}={}){super("KawaseBlurPass"),this.renderTargetA=new W(1,1,{minFilter:N,magFilter:N,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const s=this.resolution=new L(this,t,n,e);s.addEventListener("change",r=>this.setSize(s.baseWidth,s.baseHeight)),this.blurMaterial=new Ge,this.ditheredBlurMaterial=new Ge,this.ditheredBlurMaterial.uniforms.scale=this.blurMaterial.uniforms.scale,this.ditheredBlurMaterial.dithering=!0,this.dithering=!1,this.kernelSize=i}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get scale(){return this.blurMaterial.scale}set scale(e){this.blurMaterial.scale=e}getScale(){return this.blurMaterial.scale}setScale(e){this.blurMaterial.scale=e}getKernelSize(){return this.kernelSize}setKernelSize(e){this.kernelSize=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,n,i,s){const r=this.scene,o=this.camera,u=this.renderTargetA,h=this.renderTargetB,p=zn[this.kernelSize];let b=this.blurMaterial,E=t,g,A;for(this.fullscreenMaterial=b,g=0,A=p.length-1;g<A;++g){const C=(g&1)===0?u:h;b.kernel=p[g],b.inputBuffer=E.texture,e.setRenderTarget(C),e.render(r,o),E=C}this.dithering&&(b=this.ditheredBlurMaterial,this.fullscreenMaterial=b),b.kernel=p[g],b.inputBuffer=E.texture,e.setRenderTarget(this.renderToScreen?null:n),e.render(r,o)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t);const i=n.width,s=n.height;this.renderTargetA.setSize(i,s),this.renderTargetB.setSize(i,s),this.blurMaterial.setSize(i,s),this.ditheredBlurMaterial.setSize(i,s)}initialize(e,t,n){n!==void 0&&(this.renderTargetA.texture.type=n,this.renderTargetB.texture.type=n,n!==se?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.ditheredBlurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):e.outputEncoding===U&&(this.renderTargetA.texture.encoding=U,this.renderTargetB.texture.encoding=U))}static get AUTO_SIZE(){return L.AUTO_SIZE}},et=class extends H{constructor({width:e=L.AUTO_SIZE,height:t=L.AUTO_SIZE,renderTarget:n,luminanceRange:i,colorOutput:s}={}){super("LuminancePass"),this.fullscreenMaterial=new dn(s,i),this.needsSwap=!1,this.renderTarget=n,this.renderTarget===void 0&&(this.renderTarget=new W(1,1,{minFilter:N,magFilter:N,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1);const r=this.resolution=new L(this,e,t);r.addEventListener("change",o=>this.setSize(r.baseWidth,r.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,n,i,s){const r=this.fullscreenMaterial;r.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height)}initialize(e,t,n){n!==void 0&&n!==se&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},Hn=class extends H{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new Qe(!1,!1,!0),this.inverse=!1}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,n,i,s){const r=e.getContext(),o=e.state.buffers,u=this.scene,h=this.camera,p=this.clearPass,b=this.inverted?0:1,E=1-b;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),o.stencil.setFunc(r.ALWAYS,b,4294967295),o.stencil.setClear(E),o.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?p.render(e,null):(p.render(e,t),p.render(e,n))),this.renderToScreen?(e.setRenderTarget(null),e.render(u,h)):(e.setRenderTarget(t),e.render(u,h),e.setRenderTarget(n),e.render(u,h)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(r.EQUAL,1,4294967295),o.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),o.stencil.setLocked(!0)}},Vn=class extends H{constructor(e,t,{resolutionScale:n=1,width:i=L.AUTO_SIZE,height:s=L.AUTO_SIZE,renderTarget:r}={}){super("NormalPass"),this.needsSwap=!1,this.renderPass=new Je(e,t,new gt);const o=this.renderPass;o.setBackgroundDisabled(!0),o.setShadowMapDisabled(!0);const u=o.getClearPass();u.setOverrideClearColor(new Se(7829503)),u.setOverrideClearAlpha(1),this.renderTarget=r,this.renderTarget===void 0&&(this.renderTarget=new W(1,1,{minFilter:ie,magFilter:ie,stencilBuffer:!1}),this.renderTarget.texture.name="NormalPass.Target");const h=this.resolution=new L(this,i,s,n);h.addEventListener("change",p=>this.setSize(h.baseWidth,h.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,n,i,s){const r=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,r,r)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height)}},Be=1/1e3,Wn=1e3,jn=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1,this.autoReset=!1}setFixedDeltaEnabled(e){return this.fixedDeltaEnabled=e,this}isAutoResetEnabled(e){return this.autoReset}setAutoResetEnabled(e){return typeof document!="undefined"&&document.hidden!==void 0&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this.autoReset=e),this}getDelta(){return this.delta*Be}getFixedDelta(){return this.fixedDelta*Be}setFixedDelta(e){return this.fixedDelta=e*Wn,this}getElapsed(){return this.elapsed*Be}getTimescale(){return this.timescale}setTimescale(e){return this.timescale=e,this}update(e){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=e!==void 0?e:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(e){document.hidden||(this.currentTime=performance.now())}dispose(){this.setAutoResetEnabled(!1)}},Xn=class{constructor(e=null,{depthBuffer:t=!0,stencilBuffer:n=!1,multisampling:i=0,frameBufferType:s}={}){this.renderer=null,this.inputBuffer=this.createBuffer(t,n,s,i),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new qe,this.depthTexture=null,this.passes=[],this.timer=new jn,this.autoRenderToScreen=!0,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){const t=this.inputBuffer,n=this.multisampling;n>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):n!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){if(this.renderer=e,e!==null){const t=e.getSize(new I),n=e.getContext().getContextAttributes().alpha,i=this.inputBuffer.texture.type;i===se&&e.outputEncoding===U&&(this.inputBuffer.texture.encoding=U,this.outputBuffer.texture.encoding=U,this.inputBuffer.dispose(),this.outputBuffer.dispose()),e.autoClear=!1,this.setSize(t.width,t.height);for(const s of this.passes)s.initialize(e,n,i)}}replaceRenderer(e,t=!0){const n=this.renderer,i=n.domElement.parentNode;return this.setRenderer(e),t&&i!==null&&(i.removeChild(n.domElement),i.appendChild(e.domElement)),n}createDepthTexture(){const e=this.depthTexture=new vt;return this.inputBuffer.depthTexture=e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(e.format=Et,e.type=xt):e.type=bt,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,n,i){const s=this.renderer,r=s===null?new I:s.getDrawingBufferSize(new I),o={minFilter:N,magFilter:N,stencilBuffer:t,depthBuffer:e,type:n};let u;return i>0?(u=Number(Xe.replace(/\D+/g,""))<138?new Tt(r.width,r.height,o):new W(r.width,r.height,o),u.ignoreDepthForMultisampleCopy=!1,u.samples=i):u=new W(r.width,r.height,o),n===se&&s!==null&&s.outputEncoding===U&&(u.texture.encoding=U),u.texture.name="EffectComposer.Buffer",u.texture.generateMipmaps=!1,u}addPass(e,t){const n=this.passes,i=this.renderer,s=i.getDrawingBufferSize(new I),r=i.getContext().getContextAttributes().alpha,o=this.inputBuffer.texture.type;if(e.setRenderer(i),e.setSize(s.width,s.height),e.initialize(i,r,o),this.autoRenderToScreen&&(n.length>0&&(n[n.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),t!==void 0?n.splice(t,0,e):n.push(e),this.autoRenderToScreen&&(n[n.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const u=this.createDepthTexture();for(e of n)e.setDepthTexture(u)}else e.setDepthTexture(this.depthTexture)}removePass(e){const t=this.passes,n=t.indexOf(e);if(n!==-1&&t.splice(n,1).length>0){if(this.depthTexture!==null){const r=(u,h)=>u||h.needsDepthTexture;t.reduce(r,!1)||(e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&n===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){const e=this.passes;this.deleteDepthTexture(),e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){const t=this.renderer,n=this.copyPass;let i=this.inputBuffer,s=this.outputBuffer,r=!1,o,u,h;e===void 0&&(e=this.timer.update().getDelta());for(const p of this.passes)p.enabled&&(p.render(t,i,s,e,r),p.needsSwap&&(r&&(n.renderToScreen=p.renderToScreen,o=t.getContext(),u=t.state.buffers.stencil,u.setFunc(o.NOTEQUAL,1,4294967295),n.render(t,i,s,e,r),u.setFunc(o.EQUAL,1,4294967295)),h=i,i=s,s=h),p instanceof Hn?r=!0:p instanceof gn&&(r=!1))}setSize(e,t,n){const i=this.renderer;if(e===void 0||t===void 0){const r=i.getSize(new I);e=r.width,t=r.height}i.setSize(e,t,n);const s=i.getDrawingBufferSize(new I);this.inputBuffer.setSize(s.width,s.height),this.outputBuffer.setSize(s.width,s.height);for(const r of this.passes)r.setSize(s.width,s.height)}reset(){const e=this.timer.isAutoResetEnabled();this.dispose(),this.autoRenderToScreen=!0,this.timer.setAutoResetEnabled(e)}dispose(){for(const e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},tt={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},Yn=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}`,Kn=class extends k{constructor({blendFunction:e=x.SCREEN,luminanceThreshold:t=.9,luminanceSmoothing:n=.025,resolutionScale:i=.5,intensity:s=1,width:r=L.AUTO_SIZE,height:o=L.AUTO_SIZE,kernelSize:u=tt.LARGE}={}){super("BloomEffect",Yn,{blendFunction:e,uniforms:new Map([["map",new f(null)],["intensity",new f(s)]])}),this.renderTarget=new W(1,1,{minFilter:N,magFilter:N,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.luminancePass=new et({renderTarget:this.renderTarget,colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothingFactor=n,this.blurPass=new Gn({resolutionScale:i,width:r,height:o,kernelSize:u});const h=this.blurPass.getResolution();h.addEventListener("change",p=>this.setSize(h.baseWidth,h.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(e){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}update(e,t,n){const i=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(e,t,i),this.blurPass.render(e,i,i)):this.blurPass.render(e,t,i)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height),this.luminancePass.resolution.copy(n)}initialize(e,t,n){this.blurPass.initialize(e,t,n),n!==void 0&&(this.renderTarget.texture.type=n,e.outputEncoding===U&&(this.renderTarget.texture.encoding=U))}},Zn="uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",$n=class extends k{constructor({blendFunction:e=x.NORMAL,brightness:t=0,contrast:n=0}={}){super("BrightnessContrastEffect",Zn,{blendFunction:e,uniforms:new Map([["brightness",new f(t)],["contrast",new f(n)]])})}get brightness(){return this.uniforms.get("brightness").value}set brightness(e){this.uniforms.get("brightness").value=e}getBrightness(e){return this.brightness}setBrightness(e){this.brightness=e}get contrast(){return this.uniforms.get("contrast").value}set contrast(e){this.uniforms.get("contrast").value=e}getContrast(e){return this.contrast}setContrast(e){this.contrast=e}},qn="uniform float factor;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(floor(inputColor.rgb*factor+0.5)/factor,inputColor.a);}",Qn=class extends k{constructor({blendFunction:e=x.NORMAL,bits:t=16}={}){super("ColorDepthEffect",qn,{blendFunction:e,uniforms:new Map([["factor",new f(1)]])}),this.bits=0,this.bitDepth=t}get bitDepth(){return this.bits}set bitDepth(e){this.bits=e,this.uniforms.get("factor").value=Math.pow(2,e/3)}getBitDepth(){return this.bitDepth}setBitDepth(e){this.bitDepth=e}},Jn=`void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){
#ifdef INVERTED
vec3 color=vec3(1.0-depth);
#else
vec3 color=vec3(depth);
#endif
outputColor=vec4(color,inputColor.a);}`,ei=class extends k{constructor({blendFunction:e=x.NORMAL,inverted:t=!1}={}){super("DepthEffect",Jn,{blendFunction:e,attributes:J.DEPTH}),this.inverted=t}get inverted(){return this.defines.has("INVERTED")}set inverted(e){this.inverted!==e&&(e?this.defines.set("INVERTED","1"):this.defines.delete("INVERTED"),this.setChanged())}isInverted(){return this.inverted}setInverted(e){this.inverted=e}},ti="uniform vec2 angle;uniform float scale;float pattern(const in vec2 uv){vec2 point=scale*vec2(dot(angle.yx,vec2(uv.x,-uv.y)),dot(angle,uv));return(sin(point.x)*sin(point.y))*4.0;}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(inputColor.rgb*10.0-5.0+pattern(uv*resolution));outputColor=vec4(color,inputColor.a);}",ni=class extends k{constructor({blendFunction:e=x.NORMAL,angle:t=Math.PI*.5,scale:n=1}={}){super("DotScreenEffect",ti,{blendFunction:e,uniforms:new Map([["angle",new f(new I)],["scale",new f(n)]])}),this.angle=t}get angle(){return Math.acos(this.uniforms.get("angle").value.y)}set angle(e){this.uniforms.get("angle").value.set(Math.sin(e),Math.cos(e))}getAngle(){return this.angle}setAngle(e){this.angle=e}get scale(){return this.uniforms.get("scale").value}set scale(e){this.uniforms.get("scale").value=e}};new re;new yt;var ii="uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",si=class extends k{constructor({blendFunction:e=x.NORMAL,hue:t=0,saturation:n=0}={}){super("HueSaturationEffect",ii,{blendFunction:e,uniforms:new Map([["hue",new f(new re)],["saturation",new f(n)]])}),this.hue=t}get saturation(){return this.uniforms.get("saturation").value}set saturation(e){this.uniforms.get("saturation").value=e}getSaturation(){return this.saturation}setSaturation(e){this.saturation=e}get hue(){const e=this.uniforms.get("hue").value;return Math.acos((e.x*3-1)/2)}set hue(e){const t=Math.sin(e),n=Math.cos(e);this.uniforms.get("hue").value.set((2*n+1)/3,(-Math.sqrt(3)*t-n+1)/3,(Math.sqrt(3)*t-n+1)/3)}getHue(){return this.hue}setHue(e){this.hue=e}};new Se;var ri=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,ai=class extends k{constructor({blendFunction:e=x.SCREEN,premultiply:t=!1}={}){super("NoiseEffect",ri,{blendFunction:e}),this.premultiply=t}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(e){this.premultiply!==e&&(e?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(e){this.premultiply=e}},oi=`uniform float count;
#ifdef SCROLL
uniform float scrollSpeed;
#endif
void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){float y=uv.y;
#ifdef SCROLL
y+=time*scrollSpeed;
#endif
vec2 sl=vec2(sin(y*count),cos(y*count));outputColor=vec4(sl.xyx,inputColor.a);}`,ui=class extends k{constructor({blendFunction:e=x.OVERLAY,density:t=1.25,scrollSpeed:n=0}={}){super("ScanlineEffect",oi,{blendFunction:e,uniforms:new Map([["count",new f(0)],["scrollSpeed",new f(0)]])}),this.resolution=new I,this.d=t,this.scrollSpeed=n}get density(){return this.d}set density(e){this.d=e,this.setSize(this.resolution.width,this.resolution.height)}getDensity(){return this.density}setDensity(e){this.density=e}get scrollSpeed(){return this.uniforms.get("scrollSpeed").value}set scrollSpeed(e){this.uniforms.get("scrollSpeed").value=e,e===0?this.defines.delete("SCROLL")&&this.setChanged():this.defines.has("SCROLL")||(this.defines.set("SCROLL","1"),this.setChanged())}setSize(e,t){this.resolution.set(e,t),this.uniforms.get("count").value=Math.round(t*this.density)}},li="uniform bool active;uniform vec2 center;uniform float waveSize;uniform float radius;uniform float maxRadius;uniform float amplitude;varying float vSize;void mainUv(inout vec2 uv){if(active){vec2 aspectCorrection=vec2(aspect,1.0);vec2 difference=uv*aspectCorrection-center*aspectCorrection;float distance=sqrt(dot(difference,difference))*vSize;if(distance>radius){if(distance<radius+waveSize){float angle=(distance-radius)*PI2/waveSize;float cosSin=(1.0-cos(angle))*0.5;float extent=maxRadius+waveSize;float decay=max(extent-distance*distance,0.0)/extent;uv-=((cosSin*amplitude*difference)/distance)*decay;}}}}",ci="uniform float size;uniform float cameraDistance;varying float vSize;void mainSupport(){vSize=(0.1*cameraDistance)/size;}",hi=Math.PI*.5,de=new re,We=new re,di=class extends k{constructor(e,t=new re,{speed:n=2,maxRadius:i=1,waveSize:s=.2,amplitude:r=.05}={}){super("ShockWaveEffect",li,{vertexShader:ci,uniforms:new Map([["active",new f(!1)],["center",new f(new I(.5,.5))],["cameraDistance",new f(1)],["size",new f(1)],["radius",new f(-s)],["maxRadius",new f(i)],["waveSize",new f(s)],["amplitude",new f(r)]])}),this.position=t,this.speed=n,this.camera=e,this.screenPosition=this.uniforms.get("center").value,this.time=0,this.active=!1}get amplitude(){return this.uniforms.get("amplitude").value}set amplitude(e){this.uniforms.get("amplitude").value=e}get waveSize(){return this.uniforms.get("waveSize").value}set waveSize(e){this.uniforms.get("waveSize").value=e}get maxRadius(){return this.uniforms.get("maxRadius").value}set maxRadius(e){this.uniforms.get("maxRadius").value=e}get epicenter(){return this.position}set epicenter(e){this.position=e}getPosition(){return this.position}setPosition(e){this.position=e}getSpeed(){return this.speed}setSpeed(e){this.speed=e}explode(){this.time=0,this.active=!0,this.uniforms.get("active").value=!0}update(e,t,n){const i=this.position,s=this.camera,r=this.uniforms,o=r.get("active");if(this.active){const u=r.get("waveSize").value;s.getWorldDirection(de),We.copy(s.position).sub(i),o.value=de.angleTo(We)>hi,o.value&&(r.get("cameraDistance").value=s.position.distanceTo(i),de.copy(i).project(s),this.screenPosition.set((de.x+1)*.5,(de.y+1)*.5)),this.time+=n*this.speed;const h=this.time-u;r.get("radius").value=h,h>=(r.get("maxRadius").value+u)*2&&(this.active=!1,o.value=!1)}}},fi="uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,vec3(1.0,0.0,0.0)+vec3(-0.607,0.769,0.189)*intensity),dot(inputColor.rgb,vec3(0.0,1.0,0.0)+vec3(0.349,-0.314,0.168)*intensity),dot(inputColor.rgb,vec3(0.0,0.0,1.0)+vec3(0.272,0.534,-0.869)*intensity));outputColor=vec4(color,inputColor.a);}",pi=class extends k{constructor({blendFunction:e=x.NORMAL,intensity:t=1}={}){super("SepiaEffect",fi,{blendFunction:e,uniforms:new Map([["intensity",new f(t)]])})}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}},mi=`#include <tonemapping_pars_fragment>
uniform lowp sampler2D luminanceBuffer;uniform float whitePoint;uniform float middleGrey;
#if TONE_MAPPING_MODE != 2
uniform float averageLuminance;
#endif
vec3 Reinhard2ToneMapping(vec3 color){color*=toneMappingExposure;float l=linearToRelativeLuminance(color);
#if TONE_MAPPING_MODE == 2
float lumAvg=unpackRGBAToFloat(texture2D(luminanceBuffer,vec2(0.5)));
#else
float lumAvg=averageLuminance;
#endif
float lumScaled=(l*middleGrey)/max(lumAvg,1e-6);float lumCompressed=lumScaled*(1.0+lumScaled/(whitePoint*whitePoint));lumCompressed/=(1.0+lumScaled);return clamp(lumCompressed*color,0.0,1.0);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){
#if TONE_MAPPING_MODE == 1 || TONE_MAPPING_MODE == 2
outputColor=vec4(Reinhard2ToneMapping(inputColor.rgb),inputColor.a);
#else
outputColor=vec4(toneMapping(inputColor.rgb),inputColor.a);
#endif
}`,K={REINHARD:0,REINHARD2:1,REINHARD2_ADAPTIVE:2,OPTIMIZED_CINEON:3,ACES_FILMIC:4},gi=class extends k{constructor({blendFunction:e=x.NORMAL,adaptive:t=!0,mode:n=t?K.REINHARD2_ADAPTIVE:K.REINHARD2,resolution:i=256,maxLuminance:s=16,whitePoint:r=s,middleGrey:o=.6,minLuminance:u=.01,averageLuminance:h=1,adaptationRate:p=1}={}){super("ToneMappingEffect",mi,{blendFunction:e,uniforms:new Map([["luminanceBuffer",new f(null)],["maxLuminance",new f(s)],["whitePoint",new f(r)],["middleGrey",new f(o)],["averageLuminance",new f(h)]])}),this.renderTargetLuminance=new W(1,1,{minFilter:Mt,magFilter:N,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetLuminance.texture.name="Luminance",this.renderTargetLuminance.texture.generateMipmaps=!0,this.luminancePass=new et({renderTarget:this.renderTargetLuminance}),this.adaptiveLuminancePass=new mn(this.luminancePass.texture,{minLuminance:u,adaptationRate:p}),this.uniforms.get("luminanceBuffer").value=this.adaptiveLuminancePass.texture,this.resolution=i,this.mode=n}get mode(){return Number(this.defines.get("TONE_MAPPING_MODE"))}set mode(e){if(this.mode!==e){switch(this.defines.clear(),this.defines.set("TONE_MAPPING_MODE",e.toFixed(0)),e){case K.REINHARD:this.defines.set("toneMapping(texel)","ReinhardToneMapping(texel)");break;case K.OPTIMIZED_CINEON:this.defines.set("toneMapping(texel)","OptimizedCineonToneMapping(texel)");break;case K.ACES_FILMIC:this.defines.set("toneMapping(texel)","ACESFilmicToneMapping(texel)");break;default:this.defines.set("toneMapping(texel)","texel");break}this.adaptiveLuminancePass.enabled=e===K.REINHARD2_ADAPTIVE,this.setChanged()}}getMode(){return this.mode}setMode(e){this.mode=e}get adaptiveLuminanceMaterial(){return this.adaptiveLuminancePass.fullscreenMaterial}getAdaptiveLuminanceMaterial(){return this.adaptiveLuminanceMaterial}get resolution(){return this.luminancePass.resolution.width}set resolution(e){const t=Math.max(0,Math.ceil(Math.log2(e))),n=Math.pow(2,t);this.luminancePass.resolution.setPreferredSize(n,n),this.adaptiveLuminanceMaterial.mipLevel1x1=t}getResolution(){return this.resolution}setResolution(e){this.resolution=e}get adaptive(){return this.mode===K.REINHARD2_ADAPTIVE}set adaptive(e){this.mode=e?K.REINHARD2_ADAPTIVE:K.REINHARD2}get adaptationRate(){return this.adaptiveLuminanceMaterial.adaptationRate}set adaptationRate(e){this.adaptiveLuminanceMaterial.adaptationRate=e}get distinction(){return console.warn(this.name,"distinction was removed."),1}set distinction(e){console.warn(this.name,"distinction was removed.")}update(e,t,n){this.adaptiveLuminancePass.enabled&&(this.luminancePass.render(e,t),this.adaptiveLuminancePass.render(e,null,null,n))}initialize(e,t,n){this.adaptiveLuminancePass.initialize(e,t,n)}},vi=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,be={DEFAULT:0,ESKIL:1},Ei=class extends k{constructor({blendFunction:e=x.NORMAL,technique:t=be.DEFAULT,eskil:n=!1,offset:i=.5,darkness:s=.5}={}){super("VignetteEffect",vi,{blendFunction:e,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new f(i)],["darkness",new f(s)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(e){this.technique!==e&&(this.defines.set("VIGNETTE_TECHNIQUE",e.toFixed(0)),this.setChanged())}get eskil(){return this.technique===be.ESKIL}set eskil(e){this.technique=e?be.ESKIL:be.DEFAULT}getTechnique(){return this.technique}setTechnique(e){this.technique=e}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}get darkness(){return this.uniforms.get("darkness").value}set darkness(e){this.uniforms.get("darkness").value=e}getDarkness(){return this.darkness}setDarkness(e){this.darkness=e}};let fe;function xi(){if(fe!==void 0)return fe;try{var e;let t;const n=document.createElement("canvas");return fe=!!(window.WebGL2RenderingContext&&(t=n.getContext("webgl2"))),t&&((e=t.getExtension("WEBGL_lose_context"))===null||e===void 0||e.loseContext()),fe}catch{return fe=!1}}const z=function(e,t){return t===void 0&&(t=x.NORMAL),l.exports.forwardRef(function(i,s){let b=i,{blendFunction:r,opacity:o}=b,u=V(b,["blendFunction","opacity"]);const h=ne(E=>E.invalidate),p=l.exports.useMemo(()=>new e(u),[u]);return l.exports.useLayoutEffect(()=>{p.blendMode.blendFunction=!r&&r!==0?t:r,o!==void 0&&(p.blendMode.opacity.value=o),h()},[r,p.blendMode,o]),a("primitive",{ref:s,object:p,dispose:null})})},bi=z(Kn,x.SCREEN);z($n);z(Qn);z(ei);const Ti=l.exports.createContext(null),yi=Ye.memo(l.exports.forwardRef((e,t)=>{let{children:n,camera:i,scene:s,resolutionScale:r,enabled:o=!0,renderPriority:u=1,autoClear:h=!0,depthBuffer:p,disableNormalPass:b,stencilBuffer:E,multisampling:g=8,frameBufferType:A=te}=e;const{gl:C,scene:w,camera:P,size:M}=ne();s=s||w,i=i||P;const[d,c,v]=l.exports.useMemo(()=>{const T=xi(),y=new Xn(C,{depthBuffer:p,stencilBuffer:E,multisampling:g>0&&T?g:0,frameBufferType:A});y.addPass(new Je(s,i));let m=null,B=null;return b||(B=new Vn(s,i),B.enabled=!1,y.addPass(B),r!==void 0&&T&&(m=new vn({normalBuffer:B.texture,resolutionScale:r}),m.enabled=!1,y.addPass(m))),[y,B,m]},[i,C,p,E,g,A,s,b,r]);l.exports.useEffect(()=>d==null?void 0:d.setSize(M.width,M.height),[d,M]),Me((T,y)=>{o&&(C.autoClear=h,d.render(y))},o?u:0);const _=l.exports.useRef(null);l.exports.useLayoutEffect(()=>{let T;return _.current&&_.current.__r3f&&d&&(T=new kn(i,..._.current.__r3f.objects),T.renderToScreen=!0,d.addPass(T),c&&(c.enabled=!0),v&&(v.enabled=!0)),()=>{T&&(d==null||d.removePass(T)),c&&(c.enabled=!1),v&&(v.enabled=!1)}},[d,n,i,c,v]);const S=l.exports.useMemo(()=>({composer:d,normalPass:c,downSamplingPass:v,resolutionScale:r,camera:i,scene:s}),[d,c,v,r,i,s]);return l.exports.useImperativeHandle(t,()=>d,[d]),a(Ti.Provider,{value:S,children:a("group",{ref:_,children:n})})}));z(ni);z(si);z(ai,x.COLOR_DODGE);z(ui,x.OVERLAY);z(pi);z(gi);z(Ei);z(di);function Mi(t){var e=V(t,[]);const n=l.exports.useRef(),{nodes:i,materials:s}=O("/three-playground/Astronaut.glb");return a("group",Q(q({ref:n},e),{dispose:null,children:a("mesh",{geometry:i["node-0"].geometry,material:s.Astronaut_mat})}))}O.preload("/Astronaut.glb");function Si(){const t=2*Math.PI/1e3,[n,i]=l.exports.useState(0),s=l.exports.useRef();return Me(()=>{i(n+t)}),l.exports.useEffect(()=>{s.current.position.x=1.5*Math.cos(n),s.current.position.z=1.5*Math.sin(n)},[n]),D("group",{children:[a("pointLight",{intensity:3,color:"rgb(250, 200, 0)"}),D("mesh",{position:[-1,1,1],ref:s,children:[a("pointLight",{intensity:2,color:"rgb(250, 200, 0)"}),a("sphereGeometry",{args:[.2,32,32],rotation:[0,.8,0]}),a("meshStandardMaterial",{color:"rgb(250, 200, 0)"})]})]})}function wi({env:e,star:t}){const n=["night","sunset","dawn"];return a(At,{children:D(ae,{className:"w-full h-full",children:[a(oe,{makeDefault:!0,position:[3,.5,0],zoom:1}),a(ue,{enablePan:!0,enableZoom:!1,enableRotate:!0}),a(Si,{}),a(Mi,{position:[0,-1,0],scale:[.8,.8,.8],rotation:[0,Math.PI/3,0]}),t&&a($e,{radius:100,depth:100,count:5e3,factor:10,saturation:0,fade:!0,speed:1}),a(Gt,{background:!0,preset:n[e]}),a(yi,{children:a(bi,{luminanceThreshold:0,luminanceSmoothing:.9,height:900})})]})})}function _i(){const[e,t]=l.exports.useState(0),[n,i]=l.exports.useState(!1);return D("div",{id:"environment",className:"w-full h-screen bg-black relative",children:[D("div",{className:"flex absolute bottom-[10vh] left-10 z-10",children:[a("button",{className:"bg-white rounded-full px-4 mr-4",onClick:()=>{t(e===2?0:e+1)},children:"click me \u270C\uFE0F"}),a("button",{className:"bg-white rounded-full px-4",onClick:()=>i(!n),children:"stars \u2728"})]}),a(l.exports.Suspense,{fallback:a("p",{className:"text-center",children:"loading now..."}),children:a("div",{className:"w-full h-full",children:a(wi,{env:e,star:n})})})]})}function Ri(t){var e=V(t,[]);const n=l.exports.useRef(),{nodes:i,materials:s}=O("/three-playground/NeilArmstrong.glb");return D("group",Q(q({ref:n},e),{dispose:null,children:[a("mesh",{geometry:i.astronaut_1.geometry,material:s.StingrayPBS2}),a("mesh",{geometry:i.astronaut_2.geometry,material:s.StingrayPBS3}),a("mesh",{geometry:i.astronaut_3.geometry,material:s.StingrayPBS4}),a("mesh",{geometry:i.astronaut_4.geometry,material:s.StingrayPBS1})]}))}O.preload("/NeilArmstrong.glb");function Ai(){const e=l.exports.useRef(),[t,n]=l.exports.useState({mouseX:0,mouseY:0});l.exports.useEffect(()=>{const r={x:window.innerWidth/2,y:window.innerHeight/2},o=u=>{n({x:u.clientX-r.x,y:r.y-u.clientY})};return e.current.addEventListener("mousemove",o),()=>e.current.removeEventListener("mousemove",o)},[]);const i=l.exports.useRef(),s=l.exports.useRef();return l.exports.useEffect(()=>{i.current!==void 0&&(ye.to(i.current.position,{duration:1,delay:.2,x:t.x/2,y:t.y/2,z:0}),ye.to(i.current,{duration:1,intensity:Math.abs(1/t.x)}),s.current!==void 0&&ye.to(s.current.position,{duration:1,x:-1*t.x/1e3,y:-1*t.y/1e3}))},[t]),D(ae,{className:"w-full h-full",ref:e,children:[a(oe,{makeDefault:!0,position:[0,.5,3],zoom:1,ref:s}),a(ue,{enablePan:!0,enableZoom:!1,enableRotate:!0}),a("ambientLight",{intensity:.07}),a("directionalLight",{position:[0,0,0],color:[220,100,0],intensity:1e-5,ref:i}),a(Ri,{scale:[1,1,1],position:[0,-1,0],rotation:[0,0,0]}),a($e,{radius:100,depth:100,count:5e3,factor:10,saturation:0,fade:!0,speed:1})]})}function Bi(){return a("div",{id:"moving",className:"w-full h-screen flex justify-center items-center bg-black",children:a(l.exports.Suspense,{fallback:a("p",{className:"text-center",children:"loading now..."}),children:a("div",{className:"w-full h-full",children:a(Ai,{})})})})}function Ci(t){var e=V(t,[]);const n=l.exports.useRef(),{nodes:i,materials:s}=O("/three-playground/dublin.glb"),r=[s.leather_dark,s.leather_white],[o,u]=l.exports.useState(0),h=()=>{u(o===0?1:0)};return a("group",Q(q({ref:n},e),{dispose:null,children:a("group",{rotation:[-Math.PI/2,0,0],children:a("group",{rotation:[Math.PI/2,0,0],children:D("group",{position:[0,0,0],rotation:[-Math.PI/2,0,0],scale:2.54,children:[a("group",{position:[-8.19,-11.26,-5.5],children:a("group",{position:[2.83,11.07,6.58],rotation:[-Math.PI/2,0,Math.PI],children:a("mesh",{geometry:i.legs_metal_Leg_0.geometry,material:s.metal_Leg})})}),a("group",{position:[-11.54,-11.26,-21.91],children:a("group",{position:[6.17,11.07,22.98],rotation:[-Math.PI/2,0,Math.PI],children:a("mesh",{geometry:i.leatherChair_leather_white_0.geometry,material:r[o],onClick:h})})})]})})})}))}O.preload("/dublin.glb");function Di(){return D(ae,{className:"w-full h-full",children:[a(oe,{makeDefault:!0,position:[0,100,200]}),a(ue,{enablePan:!0,enableZoom:!1,enableRotate:!0}),a(we,{position:[-100,30,10],intensity:1.5}),a(Ci,{scale:[1.5,1.5,1.5],position:[0,-60,0],rotation:[0,2,0]})]})}function Pi(){return D("div",{id:"switch",className:"h-screen w-full flex items-center justify-between bg-gray-200",children:[a(l.exports.Suspense,{fallback:a("p",{className:"text-center",children:"loading now..."}),children:a(Di,{})}),a("div",{className:"w-1/2 p-[7%] pt-[14%]",children:a("p",{children:"\u{1F448}\xA0you can toggle texture by clicking it"})})]})}function Ii(){return a(Bt,{children:D("div",{className:"App",children:[a(Xt,{}),a(Zt,{}),a(Qt,{}),a(_i,{}),a(Bi,{}),a(Pi,{})]})})}Ct.createRoot(document.getElementById("root")).render(a(Ye.StrictMode,{children:a(Ii,{})}));
